# 🚀 启动指南

## 第一次使用

### 步骤 1：安装依赖

打开终端，执行以下命令：

**安装后端依赖：**
```bash
cd backend
npm install
```

**安装前端依赖：**
```bash
cd ../frontend
npm install
```

### 步骤 2：启动服务

**启动后端（终端1）：**
```bash
cd backend
npm start
```

看到 `后端服务器运行在 http://localhost:3001` 和 `数据库连接成功` 表示启动成功。

**启动前端（新开终端2）：**
```bash
cd frontend
npm run dev
```

看到类似 `Local: http://localhost:3000/` 表示启动成功。

### 步骤 3：访问应用

在浏览器中打开：`http://localhost:3000`

---

## 日常使用

每次使用时需要启动两个服务：

### 终端 1 - 后端
```bash
cd backend
npm start
```

### 终端 2 - 前端
```bash
cd frontend
npm run dev
```

---

## 🔧 常见问题

### 1. 端口被占用
**错误信息：** `Error: listen EADDRINUSE: address already in use`

**解决方法：**
- 关闭占用端口的程序
- 或修改端口号（在 `backend/server.js` 和 `frontend/vite.config.js` 中）

### 2. 数据库连接失败
**错误信息：** `数据库连接错误`

**检查清单：**
- ✅ 网络连接正常
- ✅ 数据库服务运行中
- ✅ 连接字符串正确
- ✅ 防火墙允许连接

### 3. 依赖安装失败
**解决方法：**
```bash
# 清除缓存
npm cache clean --force

# 删除 node_modules 文件夹
rm -rf node_modules

# 重新安装
npm install
```

### 4. 前端页面空白
**检查清单：**
- ✅ 后端服务已启动
- ✅ 浏览器控制台无错误
- ✅ 检查 `/api/stocks` 接口是否返回数据

---

## 📝 开发模式

### 前端热更新
前端使用 Vite，支持热模块替换（HMR），修改代码后自动刷新。

### 后端自动重启
如需后端自动重启，使用：
```bash
cd backend
npm run dev  # 使用 nodemon
```

---

## 🛠️ 生产部署

### 构建前端
```bash
cd frontend
npm run build
```

构建产物在 `frontend/dist/` 目录。

### 使用静态服务器
```bash
npm install -g serve
serve -s frontend/dist -p 3000
```

---

## 📊 测试数据库连接

创建测试文件 `backend/test-db.js`：

```javascript
const { Pool } = require('pg');

const pool = new Pool({
  connectionString: 'postgresql://root:1m3s2R7xe6LlSYJ0fq8oVKTk5Ny4P9Fu@sjc1.clusters.zeabur.com:31080/zeabur',
  ssl: { rejectUnauthorized: false }
});

async function testConnection() {
  try {
    const client = await pool.connect();
    console.log('✅ 数据库连接成功');
    
    const result = await client.query('SELECT * FROM 招股书数据 LIMIT 1');
    console.log('✅ 查询成功，示例数据：', result.rows[0]);
    
    client.release();
    process.exit(0);
  } catch (err) {
    console.error('❌ 错误：', err.message);
    process.exit(1);
  }
}

testConnection();
```

运行测试：
```bash
node backend/test-db.js
```

---

## 💡 提示

- 保持两个终端窗口开启（前端 + 后端）
- 修改前端代码时会自动刷新
- 修改后端代码需要重启后端服务
- 数据每30秒自动刷新一次

---

**祝使用愉快！** 🎉

